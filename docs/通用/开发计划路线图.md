# ğŸ“… RBAC Admin Pro å…¨æ ˆå¼€å‘è·¯çº¿å›¾

æœ¬æ–‡æ¡£è¯¦ç»†è§„åˆ’äº†ä» Mock æ¨¡å¼è¿ç§»åˆ° NestJS å…¨æ ˆæ¨¡å¼çš„å¼€å‘ä»»åŠ¡æ¸…å•ã€‚æˆ‘ä»¬å°†é‡‡ç”¨ **"åŸºç¡€è®¾æ–½ -> æ ¸å¿ƒè®¤è¯ -> ç³»ç»Ÿæ¨¡å— -> ä¸šåŠ¡åŠŸèƒ½"** çš„é¡ºåºç¨³æ­¥æ¨è¿›ã€‚

## ğŸŸ¢ ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€è®¾æ–½ä¸æ•°æ®åº“æ­å»º (Infrastructure)
**ç›®æ ‡**: è·‘é€šåç«¯è¿æ¥ï¼Œå®Œæˆæ•°æ®åº“åˆå§‹åŒ–ã€‚

- [x] **1.1 ç¯å¢ƒå‡†å¤‡**
    - [x] ç¡®è®¤æœ¬åœ° PostgreSQL æ•°æ®åº“å·²å®‰è£… (æ¨è v14+)ã€‚
    - [x] åˆ›å»ºæ•°æ®åº“ `rbac_admin_pro`ã€‚
- [x] **1.2 ORM é›†æˆ (Prisma)**
    - [x] åœ¨ `server-nestjs` åˆå§‹åŒ– Prisma: `npx prisma init`ã€‚
    - [x] é…ç½® `.env` æ•°æ®åº“è¿æ¥ä¸²ã€‚
    - [x] å°† `db/schema.sql` è½¬æ¢ä¸º Prisma Schema (`schema.prisma`)ã€‚
    - [x] æ‰§è¡Œ Migration åŒæ­¥è¡¨ç»“æ„ã€‚
- [x] **1.3 æ•°æ®åˆå§‹åŒ– (Seeding)**
    - [x] ç¼–å†™ Seed è„šæœ¬ (`prisma/seed.ts`)ã€‚
    - [x] è¿ç§» `db/init_data.sql` ä¸­çš„åˆå§‹æ•°æ®ï¼ˆç®¡ç†å‘˜è´¦å·ã€åŸºç¡€èœå•ã€å­—å…¸ï¼‰ã€‚
- [x] **1.4 ç»Ÿä¸€å“åº”å°è£…**
    - [x] å®ç° NestJS æ‹¦æˆªå™¨ (Interceptor) ç»Ÿä¸€è¿”å› `{ code: 200, msg: 'success', data: ... }` æ ¼å¼ï¼Œç¡®ä¿ä¸å‰ç«¯ Mock æ•°æ®ç»“æ„ä¸€è‡´ã€‚
    - [x] å®ç°å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨ (Filter)ã€‚

## ğŸŸ¡ ç¬¬äºŒé˜¶æ®µï¼šè®¤è¯ä¸æƒé™æ ¸å¿ƒ (Auth Core)
**ç›®æ ‡**: æ›¿æ¢å‰ç«¯ç™»å½•é€»è¾‘ï¼Œå®ç°çœŸå®çš„ JWT é‰´æƒã€‚

- [x] **2.1 ç™»å½•æ¥å£ (`/auth/login`)**
    - [x] å®ç° `AuthModule` å’Œ `AuthService`ã€‚
    - [x] éªŒè¯ç”¨æˆ·å/å¯†ç  (BCrypt åŠ å¯†)ã€‚
    - [x] ç”Ÿæˆ JWT Tokenã€‚
    - [ ] éªŒè¯ç æ¥å£ (å¯é€‰ï¼Œæš‚æœªå®ç°)ã€‚
- [x] **2.2 ç”¨æˆ·ä¿¡æ¯æ¥å£ (`/system/user/getInfo`)**
    - [x] è§£æ Token è·å–å½“å‰ UserIdã€‚
    - [x] æŸ¥è¯¢ç”¨æˆ· è§’è‰² (Roles) å’Œ æƒé™æ ‡è¯† (Permissions)ã€‚
    - [x] è¿”å›å‰ç«¯éœ€è¦çš„ `user`, `roles`, `permissions` ç»“æ„ã€‚
- [x] **2.3 åŠ¨æ€è·¯ç”±æ¥å£ (`/getRouters`)** ğŸŒŸ *æ ¸å¿ƒéš¾ç‚¹*
    - [x] æŸ¥è¯¢ `sys_menu` è¡¨ã€‚
    - [x] å®ç° listToTree ç®—æ³•ï¼Œå°†æ‰å¹³èœå•æ•°æ®è½¬æ¢ä¸ºæ ‘å½¢è·¯ç”±ç»“æ„ã€‚
    - [x] é€‚é…å‰ç«¯ Vue Router çš„ `component` è·¯å¾„è§„åˆ™ã€‚
- [x] **2.4 å‰ç«¯è”è°ƒ**
    - [x] ä¿®æ”¹å‰ç«¯ `.env.development`ï¼Œå°† API æŒ‡å‘ NestJS åç«¯ã€‚
    - [x] éªŒè¯ç™»å½•ä¸é¡µé¢è·³è½¬ï¼›èœå•åŠ è½½å½“å‰é‡‡ç”¨é™æ€è·¯ç”±ï¼Œåç«¯åŠ¨æ€è·¯ç”±å¾…å¯ç”¨ï¼ˆå‚è€ƒ `web/src/permission.ts:41-43` å–æ¶ˆæ³¨é‡Šå¹¶åœ¨è·å– `getInfo` åæŒ‚è½½åŠ¨æ€è·¯ç”±ï¼‰ã€‚

## ğŸ”µ ç¬¬ä¸‰é˜¶æ®µï¼šç³»ç»Ÿç®¡ç†æ¨¡å— (System Modules)
**ç›®æ ‡**: å®ŒæˆåŸºç¡€æ•°æ®çš„å¢åˆ æ”¹æŸ¥ (CRUD)ï¼Œæ›¿ä»£ `src/api/system` ä¸‹çš„ Mockã€‚

- [x] **3.1 ç”¨æˆ·ç®¡ç† (`/system/user`)**
    - [x] åˆ—è¡¨æŸ¥è¯¢ (åˆ†é¡µ + æœç´¢)ã€‚
    - [x] æ–°å¢/ä¿®æ”¹/åˆ é™¤ç”¨æˆ·ã€‚
    - [x] é‡ç½®å¯†ç ã€‚
- [x] **3.2 è§’è‰²ç®¡ç† (`/system/role`)**
    - [x] è§’è‰² CRUDã€‚
    - [x] **æ•°æ®æƒé™**: ä¿å­˜è§’è‰²å¯¹åº”çš„èœå• ID åˆ—è¡¨ (`sys_role_menu`)ã€‚
- [x] **3.3 èœå•ç®¡ç† (`/system/menu`)**
    - [x] èœå•æ ‘å½¢åˆ—è¡¨ã€‚
    - [x] èœå•çš„æ–°å¢/ä¿®æ”¹/åˆ é™¤ (éœ€å¤„ç†çˆ¶å­å…³ç³»)ã€‚
- [x] **3.4 éƒ¨é—¨ç®¡ç† (`/system/dept`)**
    - [x] éƒ¨é—¨æ ‘å½¢ç»“æ„ APIã€‚
- [x] **3.5 å­—å…¸ä¸å‚æ•° (`/system/dict`, `/system/config`)**
    - [x] å­—å…¸ç±»å‹ç®¡ç†å·²å®Œæˆï¼ˆ`system/dict/type` åˆ—è¡¨/æ–°å¢/ä¿®æ”¹/åˆ é™¤ï¼‰ã€‚
    - [x] ç³»ç»Ÿå‚æ•°é…ç½®å·²å®Œæˆï¼ˆ`system/config` åˆ—è¡¨/æ–°å¢/ä¿®æ”¹/åˆ é™¤/åˆ·æ–°ç¼“å­˜ï¼‰ã€‚
    - [x] å­—å…¸æ•°æ®ç®¡ç†å·²å®Œæˆï¼ˆ`system/dict/data` åˆ—è¡¨/æ–°å¢/ä¿®æ”¹/åˆ é™¤ï¼‰ã€‚

### çŠ¶æ€è¡¥å……ï¼ˆSystem Modulesï¼‰
- è§’è‰²-èœå•å…³ç³»å·²å®ç°ï¼Œä¿å­˜/æ›´æ–°é€»è¾‘è§ `server-nestjs/src/system/role/role.service.ts:93-105, 139-151`ã€‚
- å‰ç«¯ä»å­˜åœ¨ Mock ç”¨æ³•ï¼š`web/src/api/tool/gen.ts`ï¼ˆä»£ç ç”Ÿæˆï¼‰ã€‚

## ğŸŸ£ ç¬¬å››é˜¶æ®µï¼šç›‘æ§ä¸æ—¥å¿— (Monitor & Logs)
**ç›®æ ‡**: å®ç°ç³»ç»Ÿè¿ç»´èƒ½åŠ›ã€‚

- [x] **4.1 æ“ä½œæ—¥å¿—**
    - [x] å…¨å±€æ—¥å¿—æ‹¦æˆªå™¨å·²å¯ç”¨ï¼Œæ¥å£è°ƒç”¨è‡ªåŠ¨å†™å…¥ `sys_oper_log`ã€‚
- [x] **4.2 ç™»å½•æ—¥å¿—**
    - [x] ç™»å½•æˆåŠŸ/å¤±è´¥è®°å½•å†™å…¥ `sys_login_log`ã€‚
- [x] **4.3 åœ¨çº¿ç”¨æˆ·**
    - [x] åŸºäº Redis ç»´æŠ¤åœ¨çº¿ Token é›†åˆï¼Œæ”¯æŒæŸ¥è¯¢ä¸ç§»é™¤ã€‚

### çŠ¶æ€è¡¥å……ï¼ˆMonitor & Logsï¼‰
- æ“ä½œæ—¥å¿—ï¼šå…¨å±€æ‹¦æˆªå™¨ä½ç½® `server-nestjs/src/common/interceptors/oper-log.interceptor.ts`ï¼Œå…¨å±€æ³¨å†Œè§ `server-nestjs/src/app.module.ts:35-39`ã€‚
- ç™»å½•æ—¥å¿—ï¼šæœåŠ¡ä½ç½® `server-nestjs/src/monitor/login-log/login-log.service.ts`ï¼›è°ƒç”¨å…¥å£ `server-nestjs/src/auth/auth.controller.ts:18-56`ã€‚
- åœ¨çº¿ç”¨æˆ·ï¼šæœåŠ¡/æ¥å£ä½ç½® `server-nestjs/src/monitor/online/online.service.ts`ã€`online.controller.ts`ï¼›ç™»å½•/ç™»å‡ºä¸åœ¨çº¿é›†åˆè”åŠ¨è§ `auth.controller.ts:31-37, 58-66`ã€‚
- æœåŠ¡å™¨ç›‘æ§ï¼š`server-nestjs/src/monitor/server/server.controller.ts`ã€`server.service.ts`ï¼Œå‰ç«¯ `web/src/api/monitor/server.ts` å·²å¯¹æ¥ã€‚
- ç¼“å­˜ç›‘æ§ï¼š`server-nestjs/src/monitor/cache/cache.controller.ts`ã€`cache.service.ts`ï¼Œå‰ç«¯ `web/src/api/monitor/cache.ts` å·²æ”¹ä¸ºçœŸå®æ¥å£ã€‚

## âšª ç¬¬äº”é˜¶æ®µï¼šéƒ¨ç½²ä¸ä¼˜åŒ– (Deploy)
**ç›®æ ‡**: ç”Ÿäº§ç¯å¢ƒå‡†å¤‡ã€‚

- [ ] **5.1 Docker åŒ–**
    - [ ] ç¼–å†™ `Dockerfile` (Web & Server)ã€‚
    - [ ] ç¼–å†™ `docker-compose.yml` ä¸€é”®å¯åŠ¨æ•°æ®åº“å’Œåº”ç”¨ã€‚
- [ ] **5.2 ç”Ÿäº§æ„å»º**
    - [ ] å‰ç«¯æ„å»ºä¼˜åŒ– (Gzip, CDN)ã€‚
    - [ ] åç«¯ç”Ÿäº§ç¯å¢ƒé…ç½®ã€‚

### çŠ¶æ€è¡¥å……ï¼ˆDeployï¼‰
- é¡¹ç›®æœªç¼–å†™åº”ç”¨çº§ `Dockerfile` ä¸ `docker-compose.yml`ï¼ˆå½“å‰ä»…ä¾èµ–åº“å†…ç½® `bcrypt/Dockerfile`ï¼‰ã€‚

---

## ğŸ“ å…³é”®æ–‡ä»¶å‚è€ƒ
- åç«¯è®¤è¯ï¼š`server-nestjs/src/auth/auth.controller.ts`ã€`server-nestjs/src/auth/auth.service.ts`ã€`server-nestjs/src/auth/jwt.strategy.ts`ã€‚
- ç”¨æˆ·ä¿¡æ¯ï¼š`server-nestjs/src/system/user/user.controller.ts:...getInfo`ã€`user.service.ts`ã€‚
- åŠ¨æ€è·¯ç”±ï¼š`server-nestjs/src/system/menu/menu.controller.ts:...getRouters`ã€`menu.service.ts`ï¼›å‰ç«¯æŒ‚è½½å‚è€ƒ `web/src/permission.ts:41-43`ã€‚
- Prisma é›†æˆï¼š`server-nestjs/prisma/schema.prisma`ã€è¿ç§» `server-nestjs/prisma/migrations/*`ã€æœåŠ¡ `server-nestjs/src/prisma/prisma.service.ts`ã€æ¨¡å— `prisma.module.ts`ã€‚

---

## ğŸ“Œ æ‰§è¡Œå»ºè®®

å»ºè®®æŒ‰ç…§ **"ä¸€ä¸ªæ¥å£ï¼Œä¸€æ¬¡è”è°ƒ"** çš„èŠ‚å¥è¿›è¡Œï¼š
1. åç«¯å†™å¥½ä¸€ä¸ª Controller (å¦‚ `Login`).
2. ä½¿ç”¨ Postman/Swagger æµ‹è¯•é€šè¿‡.
3. å‰ç«¯åˆ‡æ¢è¯¥æ¥å£çš„ API è°ƒç”¨.
4. éªŒè¯æ— è¯¯åï¼ŒCommit ä»£ç ï¼Œå†è¿›è¡Œä¸‹ä¸€ä¸ª.
