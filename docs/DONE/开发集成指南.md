# RBAC Admin Pro 开发与后端集成指南

本文档整合了项目当前的状态说明、前端架构概览以及详细的后端集成指南。旨在帮助开发者快速了解项目全貌，并根据团队技术栈选择合适的后端方案进行对接。

## 1. 项目全貌 (Project Overview)

RBAC Admin Pro 是一个企业级通用后台管理系统，采用前后端分离架构。目前前端部分已完成 95% 的功能开发（基于 Mock 数据），包括完善的 RBAC 权限控制、动态主题、现代化仪表盘等。

### 1.1 前端核心技术栈
*   **Framework**: Vue 3.5 + TypeScript + Vite 6
*   **UI Library**: Shadcn-Vue (Radix Vue + Tailwind CSS)
*   **State Management**: Pinia (持久化存储 Token & Theme)
*   **Icons**: Lucide Vue Next
*   **Router**: Vue Router 4 (集成 NProgress)

### 1.2 已交付功能模块
*   ✅ **核心交互**: 登录鉴权、路由守卫、动态菜单、面包屑导航、Tabs 标签页。
*   ✅ **主题系统**: 7 种主题色 + 深色模式 + 圆角定制 (持久化存储)。
*   ✅ **仪表盘**: Shadcn Dashboard-01 风格，包含 KPI 卡片与图表组件。
*   ✅ **系统管理**: 用户、角色、菜单、部门、岗位管理（增删改查已完成）。
*   ✅ **系统监控**: 在线用户、日志监控等页面占位与路由配置。

---

## 2. 后端集成指南 (Backend Integration)

本项目设计为**后端无关 (Backend Agnostic)**。前端仅通过标准的 RESTful API 与后端交互。这意味着你可以自由选择 **Java (Spring Boot)**, **Go (Gin/GoFrame)**, **Node.js (NestJS)** 或其他任何语言来实现后端服务。

### 2.1 推荐技术栈方案

根据你的团队偏好，我们推荐以下三种主流方案：

#### 🏆 方案 A: NestJS (Node.js) - 全栈统一
*   **适用场景**: 前端团队主导的全栈项目，追求语言统一 (TypeScript)。
*   **优势**: 
    *   与前端共享类型定义 (DTO/Interface)。
    *   架构严谨 (Module/Controller/Service)，类似 Spring Boot 的开发体验。
    *   社区活跃，Prisma ORM 开发体验极佳。
*   **推荐组合**: NestJS + Prisma + PostgreSQL + Passport (JWT)。

##### 注：NestJS 适配器说明
- NestJS 支持不同 HTTP 服务器“适配器”：默认 `Express`，可切换为 `Fastify`。
- 切换不影响业务模块，仅在 `main.ts` 选择适配器：
  - 使用 Express（默认）：`NestFactory.create(AppModule)`。
  - 使用 Fastify：`NestFactory.create(AppModule, new FastifyAdapter())`。
- 选择建议：需要极致性能/低延迟选 `Fastify`；依赖传统中间件生态选 `Express`。

##### NestJS 适配器对比：Express vs Fastify
- 性能与资源：`Fastify` 吞吐更高、延迟更低、内存占用更小；`Express` 性能中规中矩。
- 中间件生态：`Express` 传统生态最丰富；`Fastify` 采用插件体系（`register`），常用能力均有等价插件。
- 安全与通用能力：`helmet`（Express） vs `@fastify/helmet`（Fastify）；CORS、Swagger、验证在 Nest 层一致。
- 文件与静态：`multer`（Express） vs `@fastify/multipart`（Fastify）；`express.static` vs `@fastify/static`。
- Cookie/会话：`cookie-parser`（Express） vs `@fastify/cookie`（Fastify）；服务端会话需自行方案。
- Node 流与长连接：两者均支持；Nest 的 WebSocket/SSE 与队列能力与适配器无关。
- 迁移成本：业务代码基本不变；主要更换底层中间件/插件与 `main.ts` 的适配器选择。
- 选型建议：
  - 高并发、低延迟、云原生优先 → `Fastify`
  - 依赖大量历史中间件或快速接入传统生态 → `Express`

#### 🥈 方案 B: Spring Boot (Java) - 企业级首选
*   **适用场景**: 传统的 Java 技术栈团队，对稳定性与生态有强依赖。
*   **优势**: 
    *   生态最成熟，解决方案最丰富。
    *   Spring Security 权限控制功能强大。
    *   MyBatis-Plus 极大简化 CRUD 操作。
*   **推荐组合**: Spring Boot 3 + MyBatis-Plus + Spring Security + Redis。

#### 🥉 方案 C: Go (Gin/GoFrame) - 高性能轻量级
*   **适用场景**: 对性能并发有高要求，或追求部署简单 (单二进制文件) 的场景。
*   **优势**: 
    *   启动速度快，内存占用极低。
    *   并发处理能力强。
    *   Casbin 是 Go 语言中最强大的 RBAC 权限库。
*   **推荐组合**: Gin + GORM + Casbin + JWT-Go。

### 2.2 数据库设计 (Schema)

项目根目录下提供了标准的 PostgreSQL 初始化脚本：
*   `db/schema.sql`: 表结构定义 (17 张核心表)。
*   `db/init_data.sql`: 初始化数据 (默认账号、菜单、字典等)。

**核心表结构说明**:
*   `sys_user`: 用户表 (UUID 主键)
*   `sys_role`: 角色表 (包含 `data_scope` 数据权限字段)
*   `sys_menu`: 菜单权限表 (支持 目录/菜单/按钮 三种类型)
*   `sys_dept`: 部门表 (树形结构)
*   `sys_user_role` / `sys_role_menu`: 关联表

#### 2.2.1 菜单/路由数据结构约定

`/api/getRouters` 建议返回示例（部分字段）：

```json
[
  {
    "path": "/system",
    "name": "System",
    "meta": {
      "title": "系统管理",
      "icon": "settings",
      "hidden": false
    },
    "children": [
      {
        "path": "user",
        "name": "User",
        "component": "system/user/index",
        "meta": {
          "title": "用户管理",
          "icon": "user"
        }
      }
    ]
  }
]
```
