generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

/// 部门表
model SysDept {
  deptId      String    @id @default(uuid()) @map("dept_id") @db.Uuid
  parentId    String?   @map("parent_id") @db.Uuid
  ancestors   String?   @default("") @db.VarChar(500)
  deptName    String    @map("dept_name") @db.VarChar(50)
  orderNum    Int?      @default(0) @map("order_num")
  leader      String?   @db.VarChar(20)
  phone       String?   @db.VarChar(11)
  email       String?   @db.VarChar(50)
  status      String?   @default("0") @db.Char(1) // 部门状态（0正常 1停用）
  delFlag     String?   @default("0") @map("del_flag") @db.Char(1) // 删除标志（0代表存在 2代表删除）
  createBy    String?   @default("") @map("create_by") @db.VarChar(64)
  createTime  DateTime? @default(now()) @map("create_time") @db.Timestamp(6)
  updateBy    String?   @default("") @map("update_by") @db.VarChar(64)
  updateTime  DateTime? @updatedAt @map("update_time") @db.Timestamp(6)

  // Relations
  parent      SysDept?  @relation("DeptToDept", fields: [parentId], references: [deptId])
  children    SysDept[] @relation("DeptToDept")
  users       SysUser[]
  roles       SysRoleDept[]

  @@map("sys_dept")
}

/// 用户信息表
model SysUser {
  userId      String    @id @default(uuid()) @map("user_id") @db.Uuid
  deptId      String?   @map("dept_id") @db.Uuid
  userName    String    @map("user_name") @db.VarChar(30)
  nickName    String    @map("nick_name") @db.VarChar(30)
  userType    String?   @default("00") @map("user_type") @db.VarChar(2) // 用户类型（00系统用户）
  email       String?   @default("") @db.VarChar(50)
  phonenumber String?   @default("") @db.VarChar(11)
  sex         String?   @default("0") @db.Char(1) // 用户性别（0男 1女 2未知）
  avatar      String?   @default("") @db.VarChar(100)
  password    String?   @default("") @db.VarChar(100)
  status      String?   @default("0") @db.Char(1) // 帐号状态（0正常 1停用）
  delFlag     String?   @default("0") @map("del_flag") @db.Char(1) // 删除标志（0代表存在 2代表删除）
  loginIp     String?   @default("") @map("login_ip") @db.VarChar(128)
  loginDate   DateTime? @map("login_date") @db.Timestamp(6)
  createBy    String?   @default("") @map("create_by") @db.VarChar(64)
  createTime  DateTime? @default(now()) @map("create_time") @db.Timestamp(6)
  updateBy    String?   @default("") @map("update_by") @db.VarChar(64)
  updateTime  DateTime? @updatedAt @map("update_time") @db.Timestamp(6)
  remark      String?   @db.VarChar(500)

  // Relations
  dept        SysDept?      @relation(fields: [deptId], references: [deptId])
  roles       SysUserRole[]
  posts       SysUserPost[]

  @@map("sys_user")
}

/// 岗位信息表
model SysPost {
  postId      String    @id @default(uuid()) @map("post_id") @db.Uuid
  postCode    String    @map("post_code") @db.VarChar(64)
  postName    String    @map("post_name") @db.VarChar(50)
  postSort    Int       @map("post_sort")
  status      String    @db.Char(1) // 状态（0正常 1停用）
  createBy    String?   @default("") @map("create_by") @db.VarChar(64)
  createTime  DateTime? @default(now()) @map("create_time") @db.Timestamp(6)
  updateBy    String?   @default("") @map("update_by") @db.VarChar(64)
  updateTime  DateTime? @updatedAt @map("update_time") @db.Timestamp(6)
  remark      String?   @db.VarChar(500)

  // Relations
  users       SysUserPost[]

  @@map("sys_post")
}

/// 角色信息表
model SysRole {
  roleId            String    @id @default(uuid()) @map("role_id") @db.Uuid
  roleName          String    @map("role_name") @db.VarChar(30)
  roleKey           String    @map("role_key") @db.VarChar(100)
  roleSort          Int       @map("role_sort")
  dataScope         String?   @default("1") @map("data_scope") @db.Char(1) // 数据范围（1：全部数据权限 2：自定数据权限 3：本部门数据权限 4：本部门及以下数据权限）
  menuCheckStrictly Boolean?  @default(true) @map("menu_check_strictly")
  deptCheckStrictly Boolean?  @default(true) @map("dept_check_strictly")
  status            String    @db.Char(1) // 角色状态（0正常 1停用）
  delFlag           String?   @default("0") @map("del_flag") @db.Char(1) // 删除标志（0代表存在 2代表删除）
  createBy          String?   @default("") @map("create_by") @db.VarChar(64)
  createTime        DateTime? @default(now()) @map("create_time") @db.Timestamp(6)
  updateBy          String?   @default("") @map("update_by") @db.VarChar(64)
  updateTime        DateTime? @updatedAt @map("update_time") @db.Timestamp(6)
  remark            String?   @db.VarChar(500)

  // Relations
  users       SysUserRole[]
  menus       SysRoleMenu[]
  depts       SysRoleDept[]

  @@map("sys_role")
}

/// 菜单权限表
model SysMenu {
  menuId      String    @id @default(uuid()) @map("menu_id") @db.Uuid
  menuName    String    @map("menu_name") @db.VarChar(50)
  parentId    String?   @map("parent_id") @db.Uuid
  orderNum    Int?      @default(0) @map("order_num")
  path        String?   @default("") @db.VarChar(200)
  component   String?   @db.VarChar(255)
  isFrame     Int?      @default(1) @map("is_frame") // 是否为外链（0是 1否）
  isCache     Int?      @default(0) @map("is_cache") // 是否缓存（0缓存 1不缓存）
  menuType    String?   @default("") @map("menu_type") @db.Char(1) // 菜单类型（M目录 C菜单 F按钮）
  visible     String?   @default("0") @db.Char(1) // 菜单状态（0显示 1隐藏）
  status      String?   @default("0") @db.Char(1) // 菜单状态（0正常 1停用）
  perms       String?   @db.VarChar(100)
  icon        String?   @default("#") @db.VarChar(100)
  createBy    String?   @default("") @map("create_by") @db.VarChar(64)
  createTime  DateTime? @default(now()) @map("create_time") @db.Timestamp(6)
  updateBy    String?   @default("") @map("update_by") @db.VarChar(64)
  updateTime  DateTime? @updatedAt @map("update_time") @db.Timestamp(6)
  remark      String?   @db.VarChar(500)

  // Relations
  parent      SysMenu?      @relation("MenuToMenu", fields: [parentId], references: [menuId])
  children    SysMenu[]     @relation("MenuToMenu")
  roles       SysRoleMenu[]

  @@map("sys_menu")
}

/// 用户和角色关联表
model SysUserRole {
  userId String @map("user_id") @db.Uuid
  roleId String @map("role_id") @db.Uuid

  user SysUser @relation(fields: [userId], references: [userId])
  role SysRole @relation(fields: [roleId], references: [roleId])

  @@id([userId, roleId])
  @@map("sys_user_role")
}

/// 角色和菜单关联表
model SysRoleMenu {
  roleId String @map("role_id") @db.Uuid
  menuId String @map("menu_id") @db.Uuid

  role SysRole @relation(fields: [roleId], references: [roleId])
  menu SysMenu @relation(fields: [menuId], references: [menuId])

  @@id([roleId, menuId])
  @@map("sys_role_menu")
}

/// 角色和部门关联表
model SysRoleDept {
  roleId String @map("role_id") @db.Uuid
  deptId String @map("dept_id") @db.Uuid

  role SysRole @relation(fields: [roleId], references: [roleId])
  dept SysDept @relation(fields: [deptId], references: [deptId])

  @@id([roleId, deptId])
  @@map("sys_role_dept")
}

/// 用户与岗位关联表
model SysUserPost {
  userId String @map("user_id") @db.Uuid
  postId String @map("post_id") @db.Uuid

  user SysUser @relation(fields: [userId], references: [userId])
  post SysPost @relation(fields: [postId], references: [postId])

  @@id([userId, postId])
  @@map("sys_user_post")
}

/// 操作日志记录
model SysOperLog {
  operId        String    @id @default(uuid()) @map("oper_id") @db.Uuid
  title         String?   @default("") @db.VarChar(50)
  businessType  Int?      @default(0) @map("business_type") // 业务类型（0其它 1新增 2修改 3删除）
  method        String?   @default("") @db.VarChar(100)
  requestMethod String?   @default("") @map("request_method") @db.VarChar(10)
  operatorType  Int?      @default(0) @map("operator_type") // 操作类别（0其它 1后台用户 2手机端用户）
  operName      String?   @default("") @map("oper_name") @db.VarChar(50)
  deptName      String?   @default("") @map("dept_name") @db.VarChar(50)
  operUrl       String?   @default("") @map("oper_url") @db.VarChar(255)
  operIp        String?   @default("") @map("oper_ip") @db.VarChar(128)
  operLocation  String?   @default("") @map("oper_location") @db.VarChar(255)
  operParam     String?   @default("") @map("oper_param") @db.Text
  jsonResult    String?   @default("") @map("json_result") @db.Text
  status        Int?      @default(0)
  errorMsg      String?   @default("") @map("error_msg") @db.Text
  operTime      DateTime? @default(now()) @map("oper_time") @db.Timestamp(6)

  @@map("sys_oper_log")
}

/// 字典类型表
model SysDictType {
  dictId     String    @id @default(uuid()) @map("dict_id") @db.Uuid
  dictName   String?   @default("") @map("dict_name") @db.VarChar(100)
  dictType   String?   @default("") @map("dict_type") @db.VarChar(100)
  status     String?   @default("0") @db.Char(1) // 状态（0正常 1停用）
  createBy   String?   @default("") @map("create_by") @db.VarChar(64)
  createTime DateTime? @default(now()) @map("create_time") @db.Timestamp(6)
  updateBy   String?   @default("") @map("update_by") @db.VarChar(64)
  updateTime DateTime? @updatedAt @map("update_time") @db.Timestamp(6)
  remark     String?   @db.VarChar(500)

  @@map("sys_dict_type")
}

/// 字典数据表
model SysDictData {
  dictCode   String    @id @default(uuid()) @map("dict_code") @db.Uuid
  dictSort   Int?      @default(0) @map("dict_sort")
  dictLabel  String?   @default("") @map("dict_label") @db.VarChar(100)
  dictValue  String?   @default("") @map("dict_value") @db.VarChar(100)
  dictType   String?   @default("") @map("dict_type") @db.VarChar(100)
  cssClass   String?   @map("css_class") @db.VarChar(100)
  listClass  String?   @map("list_class") @db.VarChar(100)
  isDefault  String?   @default("N") @map("is_default") @db.Char(1) // 是否默认（Y是 N否）
  status     String?   @default("0") @db.Char(1) // 状态（0正常 1停用）
  createBy   String?   @default("") @map("create_by") @db.VarChar(64)
  createTime DateTime? @default(now()) @map("create_time") @db.Timestamp(6)
  updateBy   String?   @default("") @map("update_by") @db.VarChar(64)
  updateTime DateTime? @updatedAt @map("update_time") @db.Timestamp(6)
  remark     String?   @db.VarChar(500)

  @@map("sys_dict_data")
}

/// 参数配置表
model SysConfig {
  configId    String    @id @default(uuid()) @map("config_id") @db.Uuid
  configName  String?   @default("") @map("config_name") @db.VarChar(100)
  configKey   String?   @default("") @map("config_key") @db.VarChar(100)
  configValue String?   @default("") @map("config_value") @db.VarChar(500)
  configType  String?   @default("N") @map("config_type") @db.Char(1) // 系统内置（Y是 N否）
  createBy    String?   @default("") @map("create_by") @db.VarChar(64)
  createTime  DateTime? @default(now()) @map("create_time") @db.Timestamp(6)
  updateBy    String?   @default("") @map("update_by") @db.VarChar(64)
  updateTime  DateTime? @updatedAt @map("update_time") @db.Timestamp(6)
  remark      String?   @db.VarChar(500)

  @@map("sys_config")
}

/// 系统访问记录
model SysLoginLog {
  infoId        String    @id @default(uuid()) @map("info_id") @db.Uuid
  userName      String?   @default("") @map("user_name") @db.VarChar(50)
  ipaddr        String?   @default("") @db.VarChar(128)
  loginLocation String?   @default("") @map("login_location") @db.VarChar(255)
  browser       String?   @default("") @db.VarChar(50)
  os            String?   @default("") @db.VarChar(50)
  status        String?   @default("0") @db.Char(1) // 登录状态（0成功 1失败）
  msg           String?   @default("") @db.VarChar(255)
  loginTime     DateTime? @default(now()) @map("login_time") @db.Timestamp(6)

  @@map("sys_login_log")
}

/// 通知公告表
model SysNotice {
  noticeId      String    @id @default(uuid()) @map("notice_id") @db.Uuid
  noticeTitle   String    @map("notice_title") @db.VarChar(50)
  noticeType    String    @map("notice_type") @db.Char(1) // 公告类型（1通知 2公告）
  noticeContent String?   @map("notice_content") @db.Text
  status        String?   @default("0") @db.Char(1) // 公告状态（0正常 1关闭）
  createBy      String?   @default("") @map("create_by") @db.VarChar(64)
  createTime    DateTime? @default(now()) @map("create_time") @db.Timestamp(6)
  updateBy      String?   @default("") @map("update_by") @db.VarChar(64)
  updateTime    DateTime? @updatedAt @map("update_time") @db.Timestamp(6)
  remark        String?   @db.VarChar(255)

  @@map("sys_notice")
}

/// 定时任务调度表
model SysJob {
  jobId          String    @id @default(uuid()) @map("job_id") @db.Uuid
  jobName        String?   @default("") @map("job_name") @db.VarChar(64)
  jobGroup       String?   @default("DEFAULT") @map("job_group") @db.VarChar(64)
  invokeTarget   String    @map("invoke_target") @db.VarChar(500)
  cronExpression String?   @default("") @map("cron_expression") @db.VarChar(255)
  misfirePolicy  String?   @default("3") @map("misfire_policy") @db.VarChar(20)
  concurrent     String?   @default("1") @db.Char(1) // 是否并发执行（0允许 1禁止）
  status         String?   @default("0") @db.Char(1) // 状态（0正常 1暂停）
  createBy       String?   @default("") @map("create_by") @db.VarChar(64)
  createTime     DateTime? @default(now()) @map("create_time") @db.Timestamp(6)
  updateBy       String?   @default("") @map("update_by") @db.VarChar(64)
  updateTime     DateTime? @updatedAt @map("update_time") @db.Timestamp(6)
  remark         String?   @db.VarChar(500)

  @@map("sys_job")
}

/// 定时任务调度日志表
model SysJobLog {
  jobLogId      String    @id @default(uuid()) @map("job_log_id") @db.Uuid
  jobName       String    @map("job_name") @db.VarChar(64)
  jobGroup      String    @map("job_group") @db.VarChar(64)
  invokeTarget  String    @map("invoke_target") @db.VarChar(500)
  jobMessage    String?   @map("job_message") @db.VarChar(500)
  status        String?   @default("0") @db.Char(1) // 执行状态（0正常 1失败）
  exceptionInfo String?   @map("exception_info") @db.Text
  createTime    DateTime? @default(now()) @map("create_time") @db.Timestamp(6)

  @@map("sys_job_log")
}
